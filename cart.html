<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" href="css/popup-hapus-order.css">
  
  <style>
    nav {
      max-width: 600px;
      margin: 30px auto;
      font-family:'Source Sans Pro', sans-serif;;
     
    }

    nav>a {
      color: grey;
      text-decoration: none;
      font-size: 1.02em;
      transition: color 0.15s ease;
    }

    nav>a:hover {
      color: #333;
      cursor: pointer;
    }

    nav>a>* {
      margin-right: 10px;
    }
    #orders-list > div {
      margin-bottom: 30px;
      display: flex;
      justify-content: center;
    }

    .order-item {
      display: inline-block;
      
    }

    main {
      max-width: 600px;
      margin: 30px auto;
    }

    .order-header {
      display: flex;
      margin-bottom: 25px;
      padding-top: 25px;
      padding-bottom: 5px;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid lightgrey;
    }

    .order-header h2 {
      width: 200px;
      margin: 0;
      padding-left: 30px;
      text-align: center;
    }

    .order-header>button {
      display: inline-block;
      padding: 5px 25px;
      background-color: transparent;
      border: 0;
      font-size: 1.2em;
      font-weight: bold;
      color: indianred;
      transition: color 0.15s ease;
    }

    .order-header>button:hover {
      color: firebrick;
    }

    #orders-list>div {
      margin-bottom: 25px;
    }

    img.furniture {
      width: 200px;
      height: 200px;
      margin-left: 30px;
      padding-right: 30px;
      box-shadow: 5px 5px 5px #727272
    }

    img.material,
    .color-box {
      width: 100px;
      height: 100px;
      box-shadow: 5px 5px 5px #727272
      
    }

    .item-body {
      display: flex;
      
    }

    .column-2 {
      margin-left: 20px;
      margin-top: 50px;
    }

    .column-2 > div:nth-child(2) {
      margin: 15px 0;
      
    }

    .row-1 {
      display: flex;
      justify-content: space-between;
    }

    .row-1>div {
      text-align: center;
    }

    .row-1>div:nth-child(2) {
      margin: 0 30px;
    }

    .row-2 {
      display: flex;
      justify-content: center;
    }

    .row-2>div {
      margin: 0 7px;
    }

    .row-3 {
      display: flex;
      justify-content: space-between;
    }

    body {
      background-image: linear-gradient(134deg, rgba(1, 1, 1, 0.02) 0%, rgba(1, 1, 1, 0.02) 16%, transparent 16%, transparent 76%, rgba(58, 58, 58, 0.02) 76%, rgba(58, 58, 58, 0.02) 100%), linear-gradient(215deg, rgba(166, 166, 166, 0.02) 0%, rgba(166, 166, 166, 0.02) 33%, transparent 33%, transparent 79%, rgba(111, 111, 111, 0.02) 79%, rgba(111, 111, 111, 0.02) 100%), linear-gradient(303deg, rgba(215, 215, 215, 0.02) 0%, rgba(215, 215, 215, 0.02) 7%, transparent 7%, transparent 90%, rgba(192, 192, 192, 0.02) 90%, rgba(192, 192, 192, 0.02) 100%), linear-gradient(302deg, rgba(113, 113, 113, 0.02) 0%, rgba(113, 113, 113, 0.02) 34%, transparent 34%, transparent 73%, rgba(65, 65, 65, 0.02) 73%, rgba(65, 65, 65, 0.02) 100%), linear-gradient(90deg, rgb(255, 255, 255), rgb(255, 255, 255));
      font-family: 'El Messiri', narrow;
      justify-content: center
    }

    .banner {
      margin: auto;
      width: 70%;
      border: 0px solid rgb(200, 235, 255);
      padding: 10px;
    }

    .logo {
      width: 80px;
      height: 40px;
      margin-bottom: 10px;
    }

  </style>
</head>

<body>
  <div class="banner">
    <img src="./assets/2560px.png" alt="logo ikeh" class="logo">
    </div>
    <nav>
      <a href="index.html">
        <i class="fas fa-arrow-left"></i>
        <span>halaman utama</span>
      </a>
    </nav>
    <main>
      <div id="orders-list">
        <div id="tmp-order" class="order-item">
          <div class="order-header">
            <h2 id="tmp-furniture" class="capitalize">Kursi Duar</h2>
            <button id="tmp-delete" onclick="initiateOrderDeletion(-1)">Hapus</button>
          </div>
          <div class="item-body">
            <div>
              <img id="tmp-item-image" class="furniture" src="assets/kursi-duar.jpg">
            </div>
            <div class="column-2">
              <div class="row-1">
                <div>
                  <div>Panjang</div>
                  <div id="tmp-width">100</div>
                </div>
                <div>
                  <div>Lebar</div>
                  <div id="tmp-length">75</div>
                </div>
                <div>
                  <div>Tinggi</div>
                  <div id="tmp-height">55</div>
                </div>
              </div>
              <div class="row-2">
                <div><img id="tmp-material" class="material" src="assets/material-jati.jpg"></div>
                <div id="tmp-color" class="color-box" style="background-color: lawngreen"></div>
              </div>
              <div class="row-3">
                <div>Jumlah: <span id="tmp-quantity">11</span></div>
                <div id="tmp-price">Harga: Rp2.000.000</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <div id="order-popup" class="popup-wrapper hide">
      <div class="overlay"></div>
      <div class="popup-box">
        <div class="popup-text">Are you sure deleting this order?</div>
        <div class="popup-button-wrapper">
          <button onclick="handleDeletePopupClick()">Yes, please!</button>
        </div>
      </div>
    </div>
    <script src="js/order.js"></script>
    <script>
      let deleteOrderIndex = -1;

      function initiateOrderDeletion(index) {
        document.getElementById('order-popup').classList.remove('hide');
        deleteOrderIndex = index;
      }

      function handleDeletePopupClick() {
        document.getElementById('order-popup').classList.add('hide');
        deleteOrder(deleteOrderIndex);
      }
    </script>
    <script>
      let orderItemTemplate = null;

      initiateOrderItemFactory();

      function initiateOrderItemFactory() {
        orderItemTemplate = document.getElementById('tmp-order');
      }

      function createOrderItemElement(index, order) {
        const newElement = orderItemTemplate.cloneNode(true);
        const furnitureElement = newElement.querySelector('#tmp-furniture');
        const itemImageElement = newElement.querySelector('#tmp-item-image');
        const lengthElement = newElement.querySelector('#tmp-length');
        const widthElement = newElement.querySelector('#tmp-width');
        const heightElement = newElement.querySelector('#tmp-height');
        const materialElement = newElement.querySelector('#tmp-material');
        const colorElement = newElement.querySelector('#tmp-color');
        const quantityElement = newElement.querySelector('#tmp-quantity');
        const priceElement = newElement.querySelector('#tmp-price');
        const deleteElement = newElement.querySelector('#tmp-delete');

        newElement.setAttribute('id', `order-${index}`);
        furnitureElement.innerHTML = `${order.type} ${order.model}`;
        itemImageElement.src = `assets/${order.type}-${order.model}.jpg`;
        lengthElement.innerHTML = order.length;
        widthElement.innerHTML = order.width;
        heightElement.innerHTML = order.height;
        materialElement.src = `assets/material-${order.material}.jpg`;
        colorElement.style.backgroundColor = order.color;
        quantityElement.innerHTML = order.quantity;
        priceElement.innerHTML = formatPrice(order.price);
        deleteElement.onclick = () => initiateOrderDeletion(index);

        lengthElement.removeAttribute('id');
        widthElement.removeAttribute('id');
        heightElement.removeAttribute('id');
        materialElement.removeAttribute('id');
        colorElement.removeAttribute('id');
        quantityElement.removeAttribute('id');
        priceElement.removeAttribute('id');
        deleteElement.removeAttribute('id');

        return newElement;
      }
    </script>
    <script>
      renderOrderList();

      function renderOrderList() {
        const orders = getCurrentOrders();

        if (orders.length == 0) {
          return;
        }

        const container = document.getElementById('orders-list');
        container.innerHTML = '';

        for (let i = 0; i < orders.length; i++) {
          container.appendChild(createOrderItemElement(i, orders[i]));
        }
      }

      function deleteOrder(index) {
        let orders = getCurrentOrders();

        if (orders.length == 0) {
          return;
        }

        let newOrders = [];

        for (let i = 0; i < orders.length; i++) {
          if (i != index) {
            newOrders.push(orders[i]);
          }
        }

        saveOrders(newOrders);
        renderOrderList();
      }
    </script>
</body>

</html>